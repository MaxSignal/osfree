	
CFLAGS =  -Wall  -g -I. -I.. -I/mnt/c/Projekt/osfree/src/include -pipe
CPPFLAGS = $(CFLAGS)
LDFLAGS  += -ldl

PROGRAM = test_fixup
PROGRAM_DEPS = \
	fixuplx.o \
	modlx.o

SRCS = \
	../memmgr.c \
	../modlx.c \
	../fixuplx.c \
	test_fixup.c \
	test_memmgr.c

CC = g++
# tcc g++ $(CC)

all: test_fixup test_entry test_memmgr test_native_module

fixuplx.o: ../fixuplx.c
		$(CC) $(CFLAGS) -c ../fixuplx.c -o fixuplx.o	

modlx.o: ../modlx.c
		$(CC) $(CFLAGS) -c ../modlx.c -o modlx.o

test_fixup: test_fixup.o $(PROGRAM_DEPS)
	$(CC) $(CFLAGS) $(PROGRAM_DEPS) $(LDFLAGS) test_fixup.o -o test_fixup
.c.o:
	$(CC) $(CFLAGS) -c $<

test_entry: test_entry.o  $(PROGRAM_DEPS)
	$(CC) $(CFLAGS) $(PROGRAM_DEPS) $(LDFLAGS) test_entry.c -o test_entry

native_dynlink.o: ../native_dynlink.c
	$(CC) $(CFLAGS) -c ../native_dynlink.c -o native_dynlink.o

test_native_module: test_native_module.o native_dynlink.o
	$(CC) $(CFLAGS) $(LDFLAGS) native_dynlink.o test_native_module.c -o test_native_module

memmgr.o: 
		$(CC) $(CFLAGS) -c ../memmgr.c -o memmgr.o

test_memmgr: test_memmgr.o memmgr.o
	$(CC) $(CFLAGS) $(LDFLAGS) memmgr.o test_memmgr.o -o test_memmgr
	

clean: 
	rm -f $(PROGRAM_DEPS) test_fixup.o test_fixup \
	test_entry test_entry.o test_memmgr test_memmgr.o memmgr.o \
	test_native_module.o test_native_module native_dynlink.o
